---
title: "Pooling Method + Example"
author: "Wendy"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Pooling Methods

1. Fisher's Method
  The Fisher's method sums up the log-transformed p-values obtained from individual studies.Fisher's statistic $\chi_{Fisher}^{2} = -2 \sum_{i=1}^K log(p_i)$ follows a $\chi^{2}$ distribution with $2K$ degrees of freedom under the null hypothesis. Smaller p-values contribute larger scores to the Fisher's statistic.
  
2. Stouffer's Method
  Stouffer's methods sums the inverse normal trasformed p-values. Stouffer's statistic $T\_Stouffer = \sum_{i=1}^K \frac{\Phi^{-1}(p_i)}{\sqrt{K}}$ ( $\Phi$ is the cdf of a standard normal distribution) follows a standard normal distribution under the null hypothesis. Similar to Fisher's method, smaller p-values contribute more to the Stouffer's score.
  
3. Minimum p-value Method
  The minimun p-value method take the minimum p-value among the K studies as the test statistic. It follows a beta distribution with degrees of freedom $\alpha = 1$ and $\beta = K$ under the null hypothesis.
  
4. Maximum p-value Method
  The maximum p-value method take the maximum p-value as the test statistic. It follows a beta distribution with degrees of freedom $\alpha = K$ and $\beta = 1$ under the null hypothesis.
 
# Example

1. Input dataframes
  * The number of input dataframes should between 2 and 5, and have same number of columns.

```{r}
library(MetaAnalysis)
set.seed(123)
p <- 100
# dataframe1 has 100 columns and 3 groups
data1 <- data.frame(group=sample(1:3,300,replace=TRUE),matrix(rnorm(p*300),ncol=p))
# dataframe1 has 100 columns and 2 groups
data2 <- data.frame(group=sample(1:2,200,replace=TRUE),matrix(rnorm(p*200),ncol=p))
# dataframe1 has 100 columns and 5 groups
data3 <- data.frame(group=sample(1:5,500,replace=TRUE),matrix(rnorm(p*500),ncol=p))
```
  * Input data error: if number of dataframes are out of limit, or number of columns are not equal.

2. Obtaining p-value matrix

```{r, eval = FALSE}
my.aov(data)
```

3. Pooling p-values
  * 4 pooling methods introduced above are available
  * The default method is 
  
  
When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
